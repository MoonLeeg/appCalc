# appCalc

appCalc — это распределенная система для вычисления арифметических выражений, использующая архитектуру оркестратор–агент с веб-интерфейсом. 

## Оглавление

- [Описание](#описание)
- [Возможности](#возможности)
- [Установка и запуск](#установка-и-запуск)
- [Использование](#использование)
  - [Веб-интерфейс](#веб-интерфейс)
  - [API](#api)
- [Конфигурация](#конфигурация)
- [Тестирование](#тестирование)
- [Структура проекта](#структура-проекта)
- [Примеры выражений](#примеры-выражений)

## Описание

appCalc — распределенный калькулятор, позволяющий вычислять арифметические выражения с учетом приоритетов операций. Система состоит из трех компонентов:

- **Оркестратор** – центральный сервер, принимает запросы, разбирает выражения, формирует задачи и распределяет их между агентами.
- **Агент** – рабочий процесс, исполняющий задачи (операции) и возвращающий результат оркестратору.
- **Веб-интерфейс** – фронтенд, позволяющий вводить выражения, отправлять их на сервер и получать ответы вместе с промежуточными шагами вычислений.

## Возможности

- Поддержка операций: `+`, `-`, `*`, `/`
- Соблюдение приоритетов операций и обработка скобок
- Распределенные вычисления через агентов
- Отображение промежуточных этапов вычисления
- REST API для интеграции с другими системами
- Настроиваемое время выполнения операций через переменные окружения

## Установка и запуск

### Требования

- Go 1.19 или выше
- Python 3.x (для запуска веб-интерфейса)

### Запуск компонентов

1. **Оркестратор**  
   Откройте терминал и запустите:
   ```bash
   go run orchestrator/main.go
   ```
   Сервер будет работать на порту 8080.

2. **Агент**  
   Откройте второй терминал и запустите:
   ```bash
   go run agent/main.go
   ```
   Агент подключится к оркестратору и начнет выполнять задачи.

3. **Веб-интерфейс**  
   В третьем терминале запустите веб-сервер для статики:
   ```bash
   python -m http.server 8000
   ```
   Затем откройте браузер и перейдите по адресу:
   ```
   http://localhost:8000
   ```

## Использование

### Веб-интерфейс

1. Откройте `http://localhost:8000` в браузере.
2. Введите арифметическое выражение (например, `2 + 2 * 2`).
3. Нажмите кнопку **"Вычислить"**.
4. Дождитесь отображения результата вместе с промежуточными шагами вычислений.

### API

**Создание задачи вычисления:**
```http
POST /api/v1/calculate
Content-Type: application/json

{
  "expression": "2 + 2 * 2"
}
```

**Получение результата:**
```http
GET /api/v1/expressions/{id}
```

## Конфигурация

Время выполнения операций можно настроить через переменные окружения:
- `TIME_ADDITION_MS` — время сложения (по умолчанию 1000 мс)
- `TIME_SUBTRACTION_MS` — время вычитания (по умолчанию 1000 мс)
- `TIME_MULTIPLICATIONS_MS` — время умножения (по умолчанию 1000 мс)
- `TIME_DIVISIONS_MS` — время деления (по умолчанию 1000 мс)

## Тестирование

Для запуска тестов выполните:
```bash
go test ./...
```

## Структура проекта

```
.
├── README.md
├── agent/
│   ├── main.go         # Код агента
│   └── main_test.go    # Тесты агента
├── orchestrator/
│   ├── main.go         # Код оркестратора
│   └── main_test.go    # Тесты оркестратора
├── index.html          # Веб-интерфейс
└── go.mod              # Файл зависимостей Go
```

## Примеры выражений

- `2 + 2`
- `2 + 2 * 2`
- `(2 + 2) * 2`
- `2 * 3 + 4 * 5`